---
layout: post
title: WordPress и php 7.1
date: 2017-11-05
category: wp
tags: [php7, nginx, php-fpm, plugin, server]
---

Нюансы перехода с php 7.0 на 7.1 описаны [достаточно подробно](http://php.net/manual/ru/migration71.php).

Вордпресс уже вполне совместим с последней версией `php`, хотя частных проблем [пока хватает](https://wordpress.org/search/php+7.1).

#### Переход от php 7.0 к 7.1

![WordPress & PHP 7.1](https://rifco.ru/wp-content/uploads/2017/11/PHP-7-1-and-WordPress-1-300x174.png) Если ваш провайдер предлагает поддержку `php 7.1`, стоит попробовать, особенно если переход (и обратный) можно произвести одной кнопкой.

В случае `VDS` лучше сразу не удалять предыдущую версию `php`.

В конфиге `Nginx` можно сделать на уровне `http` два бэкенда:
```Nginx
    upstream php70 {
        server unix:/run/php/php7.0-fpm.sock;
    }
    upstream php71 {
        server unix:/run/php/php7.1-fpm.sock;
    }
```
и на уровне `server / location ~ \.php$` две директивы:
```Nginx
fastcgi_pass php70;
```
и
```Nginx
fastcgi_pass php71;
```
одну из которых комментируем.

Либо можно использовать один бэкенд с одним сокетом, но запускать или останавливать соответствующий сервис `php-fpm`.

В общем, надо помнить, что разработчики тем и плагинов пока могут и не обеспечить совместимость с последней версией `php`. Попробовать перейти стоит, но надо проявить осторожность. Я попробовал на нескольких сайтах (на этом, в частности), все работает. И да, визуально нагрузка на сервер упала где-то на треть.
